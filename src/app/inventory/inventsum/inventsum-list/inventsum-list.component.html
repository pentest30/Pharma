<section class="content">
    <div class="container-fluid" style="min-height: 50%;">
        <div class="block-header">
            <div class="row">
                <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                    <ul class="breadcrumb breadcrumb-style ">
                        <li class="breadcrumb-item">
                            <h4 class="page-title">Stocks</h4>
                        </li>
                        <li class="breadcrumb-item bcrumb-1">
                            <a routerLink="/dashboard/main">
                                <i class="fas fa-home"></i>Disponible</a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        <!-- <div class="spinner-container" *ngIf="dataSource.loading$ | async">
            <mat-spinner></mat-spinner>
        </div> -->
        <div class="row clearfix">
            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                <div class="card">
                    <div class="header">
                        <div class="row">
                            <div class="col-sm-4 col-md-3">
                                <button mat-raised-button class="personlized-button" (click)="add()">
                                    <mat-icon>add</mat-icon> Ajouter
                                </button>
                            </div>
                            <div class="col-md-9">
                                <mat-slide-toggle color="primary" (change)="toggleSearch($event)" style="float: right;"  >Recherche avancée</mat-slide-toggle>
                            </div>
                        </div>                
                    </div> 
                           
                    <div class="body table-responsive">
                        <ejs-grid
                            #grid
                            style="margin-left: 10px; margin-right: 10px;"
                            showColumnMenu="true"
                            (dataBound)="dataBound($event)"
                            [gridLines]="gridLines"
                            [dataSource]="data"
                            [allowPaging]="true"
                            (commandClick)='ListingCommandClick($event)' 
                            [allowGrouping] = "true"
                            [filterSettings]='filterSettings'
                            [allowFiltering]="true"
                            [allowSorting]="true">
                            <e-columns>
                                <e-column width="150" field='productCode' headerText='Code' isPrimaryKey=true ></e-column> 
                                <e-column width="320" field='productFullName' headerText='Désignation' isPrimaryKey=true ></e-column> 
                                <e-column width="150" field='internalBatchNumber' headerText='Lot Interne' isPrimaryKey=true ></e-column> 
                                <e-column width="120" field='expiryDate' headerText='DDP'  isPrimaryKey=true format="dd/MM/yyyy" type='date'></e-column>
                                <e-column width="150" field='physicalOnhandQuantity' headerText='Vendable' isPrimaryKey=true type='number'></e-column> 
                                <e-column width="160" field='physicalDispenseQuantity' headerText='Non vendable' isPrimaryKey=true type='number'></e-column> 
                                <e-column width="150" field='physicalReservedQuantity' headerText='Réservé' isPrimaryKey=true type='number'></e-column> 
                                <e-column width="200" field='physicalAvailableQuantity' headerText='Vendable Disponible' isPrimaryKey=true type='number'></e-column> 
                                <e-column width="200" field='supplierName' headerText='Fournisseur' isPrimaryKey=true ></e-column> 
                                <e-column width="200" field='manufacturer' headerText='Laboratoire' isPrimaryKey=true ></e-column> 
                                <e-column width="200" field='purchaseUnitPrice' headerText='P.U Achat' isPrimaryKey=true format="N2" type='number'></e-column> 
                                <e-column width="200" field='value' headerText='Valeur Stock' isPrimaryKey=true type='number' format="N2"></e-column> 
                                <e-column width="120" field='isPublic' headerText='Publié' isPrimaryKey=true type='string'>
                                    <ng-template #template let-data>
                                        <i [ngClass]="{'fas':true, 'fa-lock red':!data.isPublic,'fa-unlock green':data.isPublic}"
                                        style="margin:0;padding:0;text-align: center;"></i>
                                    </ng-template>
                                </e-column> 
                                <e-column
                                field="quota"
                                headerText="Quota"
                                width="120"
                              >
                              <ng-template #filterTemplate let-data>
                                <ejs-dropdownlist id='quota' [(ngModel)]="data.Name" ngDefaultControl  [enabled]="data.column.allowFiltering" showClearButton="true"
                                  (change)=onChange($event)  [dataSource]='Quotas' [fields]='fieldType'[popupHeight]='height' >
                                </ejs-dropdownlist>
                              </ng-template>
                
                                <ng-template #template let-data>
                                  <span
                                    *ngIf="!data.quota"
                                    ></span
                                  >
                                  <span
                                    class="label bg-primary shadow-style"
                                    *ngIf="data.quota"
                                    >Quota</span
                                  >
                                </ng-template>
                              </e-column>
                                <e-column width="150" headerText='#'>
                                    <ng-template #template let-data>
                                        <button mat-icon-button [matMenuTriggerFor]="menu" class="button-action" aria-label="Click to see more actions">
                                            <i class="material-icons">more_vert</i>
                                          </button>
                                          <mat-menu #menu="matMenu">
                                           
                                            <button mat-menu-item (click)="edit(data)">
                                              <mat-icon aria-label="Edit">create</mat-icon> Modifier
                                            </button>
                                            <button mat-menu-item (click)="replinish_consume(data)">
                                                <i class="fas fa-exchange-alt mat-icon notranslate material-icons mat-icon-no-color"></i>  Réapprovisioner/Consommer
                                              </button>
                                              <button  mat-menu-item (click)="delete(data)">
                                                <mat-icon aria-label="Disable">clear</mat-icon> Supprimer
                                              </button>
                                          </mat-menu>
                                    </ng-template>
                                </e-column>
                            </e-columns>
                        </ejs-grid>
                    </div>
                </div>
            </div>
        </div>
        
    </div>
   
</section>



